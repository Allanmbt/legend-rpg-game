{"ast":null,"code":"import React,{useEffect,useRef}from'react';import'./Modal.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ItemContextMenu=_ref=>{let{position,item,onClose,onEquip,onDiscard}=_ref;const menuRef=useRef(null);// Ê∑ªÂä†ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠ËèúÂçïÁöÑÊïàÊûú\nuseEffect(()=>{const handleClickOutside=event=>{if(menuRef.current&&!menuRef.current.contains(event.target)){onClose();}};document.addEventListener('mousedown',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[onClose]);// Ë∞ÉÊï¥ËèúÂçï‰ΩçÁΩÆÔºåÈò≤Ê≠¢Ë∂ÖÂá∫Á™óÂè£\nconst adjustPosition=()=>{if(!menuRef.current)return position;const{x,y}=position;const menuWidth=menuRef.current.offsetWidth;const menuHeight=menuRef.current.offsetHeight;const windowWidth=window.innerWidth;const windowHeight=window.innerHeight;let adjustedX=x;let adjustedY=y;if(x+menuWidth>windowWidth){adjustedX=x-menuWidth;}if(y+menuHeight>windowHeight){adjustedY=y-menuHeight;}return{x:adjustedX,y:adjustedY};};const menuPosition=adjustPosition();// Ê£ÄÊü•Áâ©ÂìÅÊòØÂê¶ÂèØË£ÖÂ§á\nconst isEquippable=item&&item.slot!==undefined;return/*#__PURE__*/_jsxs(\"div\",{className:\"context-menu\",ref:menuRef,style:{left:`${menuPosition.x}px`,top:`${menuPosition.y}px`},children:[/*#__PURE__*/_jsx(\"div\",{className:\"context-menu-header\",children:/*#__PURE__*/_jsx(\"span\",{className:\"context-menu-item-name\",children:item.name})}),isEquippable&&/*#__PURE__*/_jsxs(\"div\",{className:\"context-menu-item\",onClick:()=>onEquip(item),children:[/*#__PURE__*/_jsx(\"span\",{className:\"context-menu-icon\",children:\"\\uD83D\\uDC46\"}),/*#__PURE__*/_jsx(\"span\",{className:\"context-menu-text\",children:\"\\u88C5\\u5907\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"context-menu-item\",onClick:()=>onDiscard(item),children:[/*#__PURE__*/_jsx(\"span\",{className:\"context-menu-icon\",children:\"\\uD83D\\uDDD1\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"context-menu-text\",children:\"\\u4E22\\u5F03\"})]})]});};export default ItemContextMenu;","map":{"version":3,"names":["React","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","ItemContextMenu","_ref","position","item","onClose","onEquip","onDiscard","menuRef","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","adjustPosition","x","y","menuWidth","offsetWidth","menuHeight","offsetHeight","windowWidth","window","innerWidth","windowHeight","innerHeight","adjustedX","adjustedY","menuPosition","isEquippable","slot","undefined","className","ref","style","left","top","children","name","onClick"],"sources":["D:/mm-rpg-react/src/components/Modals/ItemContextMenu.jsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport './Modal.css';\r\n\r\nconst ItemContextMenu = ({ position, item, onClose, onEquip, onDiscard }) => {\r\n    const menuRef = useRef(null);\r\n\r\n    // Ê∑ªÂä†ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠ËèúÂçïÁöÑÊïàÊûú\r\n    useEffect(() => {\r\n        const handleClickOutside = (event) => {\r\n            if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n                onClose();\r\n            }\r\n        };\r\n\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => {\r\n            document.removeEventListener('mousedown', handleClickOutside);\r\n        };\r\n    }, [onClose]);\r\n\r\n    // Ë∞ÉÊï¥ËèúÂçï‰ΩçÁΩÆÔºåÈò≤Ê≠¢Ë∂ÖÂá∫Á™óÂè£\r\n    const adjustPosition = () => {\r\n        if (!menuRef.current) return position;\r\n\r\n        const { x, y } = position;\r\n        const menuWidth = menuRef.current.offsetWidth;\r\n        const menuHeight = menuRef.current.offsetHeight;\r\n        const windowWidth = window.innerWidth;\r\n        const windowHeight = window.innerHeight;\r\n\r\n        let adjustedX = x;\r\n        let adjustedY = y;\r\n\r\n        if (x + menuWidth > windowWidth) {\r\n            adjustedX = x - menuWidth;\r\n        }\r\n\r\n        if (y + menuHeight > windowHeight) {\r\n            adjustedY = y - menuHeight;\r\n        }\r\n\r\n        return { x: adjustedX, y: adjustedY };\r\n    };\r\n\r\n    const menuPosition = adjustPosition();\r\n\r\n    // Ê£ÄÊü•Áâ©ÂìÅÊòØÂê¶ÂèØË£ÖÂ§á\r\n    const isEquippable = item && item.slot !== undefined;\r\n\r\n    return (\r\n        <div\r\n            className=\"context-menu\"\r\n            ref={menuRef}\r\n            style={{\r\n                left: `${menuPosition.x}px`,\r\n                top: `${menuPosition.y}px`\r\n            }}\r\n        >\r\n            <div className=\"context-menu-header\">\r\n                <span className=\"context-menu-item-name\">{item.name}</span>\r\n            </div>\r\n\r\n            {isEquippable && (\r\n                <div className=\"context-menu-item\" onClick={() => onEquip(item)}>\r\n                    <span className=\"context-menu-icon\">üëÜ</span>\r\n                    <span className=\"context-menu-text\">Ë£ÖÂ§á</span>\r\n                </div>\r\n            )}\r\n\r\n            <div className=\"context-menu-item\" onClick={() => onDiscard(item)}>\r\n                <span className=\"context-menu-icon\">üóëÔ∏è</span>\r\n                <span className=\"context-menu-text\">‰∏¢ÂºÉ</span>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ItemContextMenu;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}